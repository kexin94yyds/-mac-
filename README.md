# 📱 macOS 屏幕使用时间工具

一个仿 iPhone 电池界面风格的 macOS 屏幕使用时间查询工具，让您轻松查看 Mac 上各个应用的使用时长。

![演示](https://img.shields.io/badge/macOS-兼容-brightgreen) ![Python](https://img.shields.io/badge/Python-3.6+-blue) ![License](https://img.shields.io/badge/license-MIT-green)

## ✨ 功能特色

- 🎨 **iPhone 风格界面** - 仿 iOS 电池使用界面的美观设计
- 📊 **可视化条形图** - 直观显示各应用使用时长占比
- ⏱️ **多时间范围** - 支持 24小时、7天、30天或自定义天数
- 🚀 **快速调用** - 全局命令 `电池` 或 `st` 随时查看
- 📤 **数据导出** - 支持导出 JSON 格式数据
- 🔍 **智能识别** - 自动识别应用中文名称

## 📋 系统要求

- macOS 10.15+ (Catalina 或更高版本)
- Python 3.6+
- Terminal 应用的「完全磁盘访问」权限

## 🚀 快速开始

### 1. 克隆仓库

```bash
git clone https://github.com/kexin94yyds/-mac-.git
cd -mac-
```

### 2. 设置权限（重要！）

⚠️ **必须操作**：给 Terminal 授予完全磁盘访问权限

1. 打开 `系统设置` → `隐私与安全性` → `完全磁盘访问`
2. 点击 `+` 号，添加 `Terminal` 应用
3. 确保 Terminal 旁边的开关是开启状态
4. 重启 Terminal

### 3. 安装并使用

```bash
# 添加执行权限
chmod +x screen_time_checker.py st 电池

# 创建全局命令（需要输入密码）
sudo ln -sf "$(pwd)/st" /usr/local/bin/st
sudo ln -sf "$(pwd)/电池" /usr/local/bin/电池
```

### 4. 开始使用

```bash
# 查看过去24小时使用情况（默认 iPhone 风格）
电池

# 或者使用英文命令
st
```

## 💡 使用方法

### 基本命令

```bash
电池              # 过去24小时（iPhone风格界面）
电池 7            # 过去7天
电池 30           # 过去30天
电池 visual       # iPhone风格界面
电池 export       # 导出JSON数据
电池 debug        # 调试模式
电池 help         # 查看帮助
```

### 英文命令

```bash
st               # 等同于 电池
st week          # 过去一周  
st month         # 过去一个月
st iphone 7      # iPhone风格显示过去7天
```

## 📊 界面示例

### iPhone 风格界面
```
────────────────────────────────────────────────────────────
                            🔋 电池                            
────────────────────────────────────────────────────────────
                          过去 24 小时                          

                          屏幕总使用时间                           
                           8小时5分钟                           

                          App的使用时长                          
────────────────────────────────────────────────────────────
  Safari          ██████████████████████████████ 25.4% (2小时2分钟)
  Chrome          █████████████████████░░░░░░░░░ 17.8% (1小时25分钟)
  VS Code         █████████████░░░░░░░░░░░░░░░░░ 11.6% (56分钟)
  微信              ██████████░░░░░░░░░░░░░░░░░░░░  9.1% (44分钟)
  ────────────────────────────────────────────────────────────
```

## 📁 文件说明

- `screen_time_checker.py` - 主程序文件
- `st` - 英文快速启动脚本
- `电池` - 中文快速启动脚本
- `使用说明.md` - 详细使用说明
- `README.md` - 项目说明文档

## 🔧 高级功能

### 数据导出

```bash
# 导出过去24小时数据
电池 export

# 导出过去7天数据  
电池 export 7
```

导出的 JSON 文件包含：
- 导出时间
- 时间范围
- 每个应用的详细使用数据
- Bundle ID 和友好名称映射

### 调试模式

```bash
# 查看详细计算信息
电池 debug
```

显示总时长计算验证和详细统计信息。

## ❓ 常见问题

**Q: 显示 "❌ 无法访问数据库"**  
A: 需要在系统设置中给 Terminal 添加"完全磁盘访问"权限

**Q: 没有显示数据或数据很少**  
A: 可能是 macOS 版本较新或最近重装系统，需要使用一段时间后才有数据

**Q: 应用名称显示不正确**  
A: 脚本会尝试自动识别应用名称，部分应用可能显示为英文名或 Bundle ID

**Q: 总使用时间是否准确？**  
A: 数据来源于系统内置的 knowledgeC.db 数据库，准确度很高，计算方式与 iOS 屏幕使用时间相同

## 🛠️ 技术原理

本工具读取 macOS 系统的 `~/Library/Application Support/Knowledge/knowledgeC.db` 数据库，这是系统用于记录应用使用情况的 SQLite 数据库。通过查询 `ZOBJECT` 表中 `ZSTREAMNAME` 为 `/app/usage` 和 `/app/inFocus` 的记录来获取应用使用时长。

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## ⭐ 支持项目

如果这个工具对您有帮助，请给项目点个 Star ⭐️

---

**注意**: 本工具仅用于个人使用情况分析，不会收集或上传任何数据。所有数据处理均在本地完成。 